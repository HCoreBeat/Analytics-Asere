<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Analytics Asere</title>

    <!-- Favicons -->
    <link rel="icon" href="img/Asere Logo M.png" type="image/png">

    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/floating-bot.css">
    <link rel="stylesheet" href="css/servidor.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-chart-network"></i>
                <span>Analytics Asere</span>
            </div>
            <button class="close-menu"><i class="fas fa-times"></i></button>
        </div>
        
        <div class="menu-items">
            <button class="menu-item active" data-view="dashboard">
                <i class="fas fa-chart-pie"></i>
                <span>Dashboard</span>
            </button>
            <button class="menu-item" data-view="products">
                <i class="fas fa-boxes"></i>
                <span>Productos</span>
            </button> 
            <button class="btn btn-secondary" id="open-image-manager">
                <i class="fas fa-images"></i> Gestor de Im√°genes
            </button>
            <button class="menu-item" data-view="temporary-affiliates">
                <i class="fas fa-handshake"></i>
                <span>Afiliados Permanentes</span>
            </button>
            <button class="menu-item" data-view="affiliates">
                <i class="fas fa-user-clock"></i>
                <span>Afiliados Temporales</span>
            </button>
            <button class="menu-item" data-view="servidor">
                <i class="fas fa-server"></i>
                <span>Servidor</span>
            </button>
        </div>

        <div class="filters">
            <div class="filter-group">
                <label for="filter-period"><i class="fas fa-calendar-alt"></i> Periodo</label>
                <select id="filter-period" class="select-dark">
                    <option value="month">Este Mes</option>
                    <option value="last-month">Mes Pasado</option>
                    <option value="year">Este A√±o</option>
                    <option value="all">Todos</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="filter-date-start"><i class="fas fa-calendar-week"></i> Rango de Fechas</label>
                <div class="date-range">
                    <input type="date" id="filter-date-start" class="input-dark">
                    <span>a</span>
                    <input type="date" id="filter-date-end" class="input-dark">
                </div>
            </div>
            <div class="filter-group">
                <label for="filter-country"><i class="fas fa-flag"></i> Pa√≠s</label>
                <select id="filter-country" class="select-dark"></select>
            </div>
            <div class="filter-group">
                <label for="filter-affiliate"><i class="fas fa-handshake"></i> Afiliado</label>
                <select id="filter-affiliate" class="select-dark"></select>
            </div>
            <div class="filter-group">
                <label for="filter-user-type"><i class="fas fa-user-tie"></i> Tipo usuario</label>
                <select id="filter-user-type" class="select-dark"></select>
            </div>
        </div>
    </nav>

    <!-- Modal para el token -->
    <div id="token-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3><i class="fas fa-key"></i> Autenticaci√≥n requerida</h3>
            <p>Para actualizar los afiliados, y actualizar los productos agrega la llave:</p>
            
            <div class="input-group">
                <label for="github-token-input">LLave de acceso:</label>
                <input type="text" id="github-token-input" class="input-dark" 
                    placeholder="ghp_tu llave Aqu√≠">
            </div>
            
            <div class="modal-actions">
                <button id="cancel-token-btn" class="btn cancel-btn">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button id="submit-token-btn" class="btn btn-primary">
                    <i class="fas fa-check"></i> Guardar Llave
                </button>
            </div>
            
            <div class="token-help">
                <p><small>¬øC√≥mo obtener un llave üôÇ?</small></p>
                <ol>
                    <li>Pidele a <code>Huguito</code> que te de la llave de acceso</li>
                    <li>C√≥pialo y p√©galo aqu√≠</li>
                </ol>
                <p><small>No pierdas la llave o se va todo a la verga, ojito con andar compartiendo cosas que no debes üôÇüëå.</small></p>
            </div>
        </div>
    </div>

    <main class="content">
        <!-- Vista Dashboard -->
        <div id="dashboard-view" class="view-content">
            <header class="header">
                <div class="header-top">
                    <div class="menu-left">
                        <button class="menu-toggle"><i class="fas fa-bars"></i> Men√∫</button>
                        <img src="img/logo_2.png" alt="Logo" class="header-logo" />
                    </div>
                    <div class="search-bar">
                        <input type="text" id="search-orders" placeholder="Buscar en pedidos..." class="input-dark">
                        <button class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    
                    <div class="status-indicator">
                        <span class="connection-status">
                            <i class="fas fa-circle"></i>
                            <span id="connection-status-text">Verificando...</span>
                        </span>
                        <span class="repo-status">
                            <i class="fas fa-code-branch"></i>
                            <span id="repo-status-text">Repositorio</span>
                        </span>
                    </div>

                    <div class="header-actions">
                        <button class="btn btn-primary btn-export">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                        <button class="btn btn-primary" id="refresh-data">
                            <i class="fas fa-sync-alt"></i> Actualizar
                        </button>
                        <button class="btn btn-secondary" id="settings-btn">
                            <i class="fas fa-cog"></i> 
                        </button>
                    </div>
                </div>
                <div class="header-main">
                    <div class="header-stats">
                        <div class="stat-card primary">
                            <i class="fas fa-chart-pie"></i>
                            <div class="stat-content">
                                <span class="stat-value" id="total-orders">0</span>
                                <span class="stat-label">Pedidos Totales</span>
                            </div>
                            <div class="currency-panel euro">
                                <span class="stat-value" id="total-sales">‚Ç¨0</span>
                                <span class="stat-label">Ventas Totales</span>
                            </div>
                        </div>
                        <div class="stat-card accent">
                            <i class="fas fa-coins"></i>
                            <div class="stat-content">
                                <div class="dual-currency">
                                    <div class="currency-panel dollar">
                                        <span class="stat-value" id="total-sales-usd">$0</span>
                                        <span class="stat-label">Ventas (USD)</span>
                                    </div>
                                    <div class="currency-panel euro">
                                        <span class="stat-value" id="total-sales-eur">‚Ç¨0</span>
                                        <span class="stat-label">Ventas (EUR)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-cube"></i>
                            <div class="stat-content">
                                <span class="stat-value" id="total-products">0</span>
                                <span class="stat-label">Productos Vendidos</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-users"></i>
                            <div class="stat-content">
                                <span class="stat-value" id="unique-customers">0</span>
                                <span class="stat-label">Clientes √önicos</span>
                            </div>
                        </div>
                    </div>
                </div>
                                
            </header>

            <section class="dashboard-grid">
                <div class="insights-grid">
                    <div class="card summary-card">
                        <h3 class="card-title"><i class="fas fa-chart-bar"></i> Resumen General</h3>
                        <div class="summary-grid" id="general-summary"></div>
                    </div>

                    <!-- Resumen diario/semanal -->
                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Resumen Semanal</h3>
                        <div class="summary-grid" id="weekly-summary"></div>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-globe-americas"></i> Distribuci√≥n por Pa√≠ses</h3>
                        <div class="chart-container">
                            <canvas id="country-chart" width="300" height="200"></canvas>
                        </div>
                        <div class="ranking-list compact" id="country-distribution"></div>
                    </div>

                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-star"></i> Top Productos</h3>
                        <div class="chart-container">
                            <canvas id="products-chart" width="300" height="200"></canvas>
                        </div>
                        <div class="ranking-list compact" id="top-products"></div>
                    </div>

                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-chart-line"></i> Tendencias de Ventas</h3>
                        <div class="chart-container">
                            <canvas id="sales-trend-chart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card full-width transactions-card">
                    <div class="card-header-with-tabs">
                        <h3 class="card-title"><i class="fas fa-exchange-alt"></i> Transacciones Recientes</h3>
                        <div class="tabs">
                            <button class="tab-btn active" data-tab="all">Todos</button>
                            <button class="tab-btn" data-tab="affiliated">Con Afiliado</button>
                            <button class="tab-btn" data-tab="direct">Directos</button>
                        </div>
                    </div>
                    <div id="orders-list" class="orders-container"></div>
                </div>
            </section>
        </div>  

        <!-- Vista Afiliados temporales -->
        <div id="affiliates-view" class="view-content hidden">
            <header class="header">
                <div class="header-top">
                    <button class="menu-toggle"><i class="fas fa-bars"></i> Men√∫</button>
                    <div class="search-bar">
                        <input type="text" id="search-affiliates" placeholder="Buscar afiliados..." class="input-dark">
                        <button class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                </div>
                <h2><i class="fas fa-handshake"></i> Afiliados temporales</h2>
            </header>

            <section class="affiliates-section">
                <div class="affiliates-actions-bar">
                    <button class="btn btn-primary" id="show-add-affiliate-form">
                        <i class="fas fa-plus"></i> Agregar Afiliado
                    </button>
                    <button class="btn btn-primary" id="refresh-affiliates">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                </div>

                        <div id="add-affiliate-panel" class="card full-width" style="display: none;">
                    <h3 class="card-title"><i class="fas fa-user-plus"></i> Nuevo Afiliado Temporal</h3>
                    <form id="add-affiliate-form" class="affiliate-form">
                        <div class="form-group">
                            <label for="affiliate-name">Nombre Completo *</label>
                            <input type="text" id="affiliate-name" class="input-dark" required>
                        </div>
                        <div class="form-group">
                            <label for="affiliate-phone">Tel√©fono (opcional)</label>
                            <input type="text" id="affiliate-phone" class="input-dark">
                        </div>
                        <div class="form-group">
                            <div class="field-label">Informaci√≥n generada autom√°ticamente</div>
                            <div class="auto-generated-info">
                                <div class="info-item">
                                    <span>ID:</span>
                                    <span id="generated-id">Se generar√° al guardar</span>
                                </div>
                                <div class="info-item">
                                    <span>Fecha de Registro:</span>
                                    <span id="generated-date">${new Date().toLocaleDateString('es-ES')}</span>
                                </div>
                                <div class="info-item">
                                    <span>Enlace de Afiliado:</span>
                                    <span id="generated-link">Se generar√° al guardar</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn cancel-btn" id="cancel-add-affiliate">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Guardar Afiliado
                            </button>
                        </div>
                    </form>
                </div>

                <div class="card full-width">
                    <div class="affiliates-header">
                        <h3 class="card-title">Listado de Afiliados Registrados</h3>
                        <div class="sort-options">
                            <span>Ordenar por:</span>
                            <select id="sort-affiliates" class="select-dark">
                                <option value="date-desc">Fecha (m√°s reciente primero)</option>
                                <option value="date-asc">Fecha (m√°s antiguo primero)</option>
                                <option value="name-asc">Nombre (A-Z)</option>
                                <option value="name-desc">Nombre (Z-A)</option>
                            </select>
                        </div>
                    </div>
                    <div id="affiliates-list" class="affiliates-container"></div>
                </div>
            </section>
        </div>

        <!-- Vista Afiliados Permanentes -->
        <div id="temporary-affiliates-view" class="view-content hidden">
            <header class="header">
                <div class="header-top">
                    <button class="menu-toggle"><i class="fas fa-bars"></i> Men√∫</button>
                    <div class="search-bar">
                        <input type="text" id="search-temporary-affiliates" placeholder="Buscar afiliados temporales..." class="input-dark">
                        <button class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                </div>
                <h2><i class="fas fa-user-clock"></i> Afiliados Permanentes</h2>
            </header>

            <section class="affiliates-section">
                <div class="card full-width">
                    <div class="affiliates-header">
                        <h3 class="card-title">Afiliados de registro Permanente</h3>
                        <div class="sort-options">
                            <span>Ordenar por:</span>
                            <select id="sort-temporary-affiliates" class="select-dark">
                                <option value="number-desc">N√∫mero (mayor a menor)</option>
                                <option value="number-asc">N√∫mero (menor a mayor)</option>
                                <option value="date-desc">Fecha (m√°s reciente primero)</option>
                                <option value="date-asc">Fecha (m√°s antiguo primero)</option>
                                <option value="name-asc">Nombre (A-Z)</option>
                                <option value="name-desc">Nombre (Z-A)</option>
                            </select>
                        </div>
                        <div class="affiliates-actions">
                            <button class="btn btn-primary" id="refresh-temporary-affiliates">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                    </div>
                    <div id="temporary-affiliates-list" class="affiliates-container"></div>
                </div>
            </section>
        </div>

        <!-- Add this view content section -->
        <div id="products-view" class="view-content hidden">
            <header class="header">
                <div class="header-top">
                    <button class="menu-toggle"><i class="fas fa-bars"></i> Men√∫</button>
                    <div class="search-filters">
                        <div class="search-bar">
                            <input type="text" id="search-products" placeholder="Buscar productos..." class="input-dark">
                            <button class="search-btn"><i class="fas fa-search"></i></button>
                        </div>
                        <div class="product-filters">
                            <select id="filter-category" class="select-dark">
                                <option value="">Todas las categor√≠as</option>
                            </select>
                            <select id="filter-availability" class="select-dark">
                                <option value="">Todos</option>
                                <option value="available">Disponibles</option>
                                <option value="unavailable">Agotados</option>
                            </select>
                            <select id="filter-featured" class="select-dark">
                                <option value="">Todos</option>
                                <option value="featured">Destacados</option>
                                <option value="offer">En oferta</option>
                            </select>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="add-product-btn">
                            <i class="fas fa-plus"></i> Nuevo
                        </button>
                        <button class="btn btn-primary" id="refresh-products">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <!-- Bot√≥n para alternar entre panel de Productos y Productos modificados -->
                        <button class="btn btn-secondary" id="toggle-panel-btn">
                            <i class="fas fa-columns"></i> <span class="toggle-label">Cambiar Panel</span>
                            <span id="staged-count-badge" class="panel-badge" style="display: none;">0</span>
                        </button>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-card">
                        <i class="fas fa-box-open"></i>
                        <div class="stat-content">
                            <span class="stat-value" id="total-products">0</span>
                            <span class="stat-label">Productos Totales</span>
                        </div>
                    </div>
                </div>
            </header>
        
            <section class="products-section">
                <div class="products-layout">
                    <div class="staged-column">
                        <!-- Segmento: Productos modificados (staging local) -->
                        <div id="staged-changes-panel" class="card staged-panel">
                            <div class="card-header-with-tabs">
                                <h3 class="card-title"><i class="fas fa-save"></i> Productos modificados (Guardado local)</h3>
                                <div class="staged-actions">
                                    <button id="save-all-staged" class="btn btn-primary">
                                        <i class="fas fa-check"></i> Guardar general
                                    </button>
                                    <button id="cancel-all-staged" class="btn cancel-btn">
                                        <i class="fas fa-times"></i> Cancelar todos
                                    </button>
                                </div>
                            </div>
                            <div class="staged-body">
                                <p class="muted">Aqu√≠ aparecen las modificaciones que guardes localmente. Puedes editar o descartar antes de realizar el guardado general a la base de datos.</p>
                                <ul id="staged-changes-list" class="staged-list"></ul>
                            </div>
                        </div>
                    </div>

                    <div class="products-column">
                        <div id="products-list" class="products-grid"></div>
                    </div>
                </div>
                
                <!-- Product Editor Modal -->
                <div id="product-editor-modal" class="modal hidden">
                    <div class="modal-content large-modal">
                        <div class="modal-header">
                            <h3><i class="fas fa-edit"></i> <span id="editor-title">Editar Producto</span></h3>
                            <button class="close-modal" id="close-product-editor">&times;</button>
                        </div>
                        
                        <div class="modal-body">
                        <form id="product-form" class="product-form">
                            <div class="form-columns">
                                <div class="form-column left">
                                    <div class="form-group">
                                        <label for="product-name">Nombre *</label>
                                        <input type="text" id="product-name" class="input-dark" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="product-category">Categor√≠a *</label>
                                        <select id="product-category" class="select-dark" required>
                                            <option value="">Seleccionar categor√≠a</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="product-price">Precio de venta ($) *</label>
                                        <input type="number" id="product-price" class="input-dark" step="0.01" min="0" required>
                                        <div class="hint hidden">Precio final: <span id="final-price-hint">$0.00</span></div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="product-discount">Descuento (%)</label>
                                        <input type="number" id="product-discount" class="input-dark" step="0.01" min="0" max="100" value="0">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="product-description">Descripci√≥n</label>
                                        <textarea id="product-description" class="input-dark" rows="3"></textarea>
                                    </div>
                                </div>
                                
                                <div class="form-column right">
                                    <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
                                        <div class="form-group">
                                            <div class="field-label">Estado</div>
                                            <div class="switch-group">
                                                <label class="switch">
                                                    <input type="checkbox" id="product-disponible" checked="">
                                                    <span class="slider"></span>
                                                    <span class="switch-label">Disponible</span>
                                                </label>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <div class="field-label">Producto Nuevo</div>
                                            <div class="switch-group">
                                                <label class="switch">
                                                    <input type="checkbox" id="product-nuevo" checked="">
                                                    <span class="slider"></span>
                                                    <span class="switch-label">Es Nuevo</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <div class="field-label">Destacado</div>
                                            <div class="switch-group">
                                                <label class="switch">
                                                    <input type="checkbox" id="product-mas-vendido">
                                                    <span class="slider"></span>
                                                    <span class="switch-label">M√°s vendido</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <div class="field-label">Oferta</div>
                                            <div class="switch-group">
                                                <label class="switch">
                                                    <input type="checkbox" id="product-oferta">
                                                    <span class="slider"></span>
                                                    <span class="switch-label">En oferta</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                 
                                    <div class="form-group">
                                        <label for="main-image-upload">Imagen principal *</label>
                                        <div class="image-upload-container">
                                            <div class="current-image-container" id="main-image-container">
                                                <span>No hay imagen seleccionada</span>
                                            </div>
                                            <div class="image-upload-actions">
                                                <input type="file" id="main-image-upload" accept="image/*" style="display: none;">
                                                <button type="button" class="btn btn-secondary" id="select-main-image">
                                                    <i class="fas fa-image"></i> Seleccionar
                                                </button>
                                                <button type="button" class="btn cancel-btn" id="remove-main-image" style="display: none;">
                                                    <i class="fas fa-trash"></i> Eliminar
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="additional-images-upload">Im√°genes adicionales</label>
                                        <div class="additional-images-container" id="additional-images-container">
                                            <div class="no-images-message">No hay im√°genes adicionales</div>
                                        </div>
                                        <div class="image-upload-actions">
                                            <input type="file" id="additional-images-upload" accept="image/*" multiple style="display: none;">
                                            <button type="button" class="btn btn-secondary" id="add-additional-images">
                                                <i class="fas fa-plus"></i> Agregar im√°genes
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group full-width hidden" id="json-preview-container">
                                <div class="field-label">Vista previa del JSON</div>
                                <pre id="product-json-preview" class="json-preview"></pre>
                            </div>
                            
                            <button type="button" id="toggle-json-preview" class="btn btn-secondary">
                                <i class="fas fa-eye"></i> Mostrar Vista Previa
                            </button>

                            <div class="form-actions">
                                <button type="button" id="cancel-product-edit" class="btn cancel-btn">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Aceptar Cambios
                                </button>
                            </div>
                        </form>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        <!-- Modal para gesti√≥n de im√°genes -->
        <div id="image-manager-modal" class="modal hidden">
            <div class="modal-content large-modal">
                <div class="modal-header">
                    <h3><i class="fas fa-images"></i> Gestor de Im√°genes</h3>
                    <button class="close-modal" id="close-image-manager">&times;</button>
                </div>
                
                <div class="image-manager-content">
                    <div class="image-manager-actions">
                        <button id="refresh-images" class="btn btn-primary">
                            <i class="fas fa-sync-alt"></i> Actualizar Lista
                        </button>
                        <button id="delete-selected-images" class="btn btn-secondary" disabled>
                            <i class="fas fa-trash"></i> Eliminar Seleccionadas
                        </button>
                        <div class="selection-counter">
                            <span id="selected-count">0</span> seleccionadas
                        </div>
                    </div>
                    
                    <div class="image-manager-filters">
                        <select id="filter-image-type" class="select-dark">
                            <option value="all">Todas las im√°genes</option>
                            <option value="used">En uso</option>
                            <option value="unused">No usadas</option>
                        </select>
                    </div>
                    
                    <div id="repository-images-grid" class="images-grid">
                        <div class="loading-placeholder">
                            <i class="fas fa-spinner fa-spin"></i> Cargando im√°genes...
                        </div>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button id="confirm-image-deletion" class="btn btn-primary hidden">
                        <i class="fas fa-check"></i> Confirmar Eliminaci√≥n (Eliminar <span id="delete-count">0</span>)
                    </button>
                    <button id="cancel-image-deletion" class="btn cancel-btn hidden">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <button id="close-image-manager-btn" class="btn cancel-btn">
                        <i class="fas fa-times"></i> Cerrar
                    </button>
                </div>
            </div>
        </div>

    <!-- Servidor view (moved above footer so footer stays below content) -->
    <div id="servidor-view" class="view-content hidden">
        <header class="header">
            <div class="header-top">
                <div class="menu-left">
                    <button class="menu-toggle"><i class="fas fa-bars"></i> Men√∫</button>
                </div>
                <div class="search-bar">
                    <input type="text" id="server-search" placeholder="Buscar..." class="input-dark">
                    <button class="search-btn"><i class="fas fa-search"></i></button>
                </div>
                <div class="header-actions">
                    <button id="btn-get-server-status" class="btn btn-primary" title="Refrescar"><i class="fas fa-sync-alt"></i> <span class="btn-text">Refrescar</span></button>
                    <button id="btn-update-comparison" class="btn btn-secondary" title="Forzar Comparaci√≥n"><i class="fas fa-exchange-alt"></i> <span class="btn-text">Forzar</span></button>
                    <button id="btn-save-new-orders" class="btn btn-warning" title="Guardar pedidos nuevos en GitHub"><i class="fas fa-cloud-upload-alt"></i> <span class="btn-text">Guardar Pedidos</span></button>
                    <button id="btn-clear-statistics" class="btn cancel-btn" title="Limpiar Estad√≠sticas"><i class="fas fa-trash-alt"></i> <span class="btn-text">Limpiar</span></button>
                </div>
            </div>
            <h2><i class="fas fa-server"></i> Servidor</h2>
        </header>

        <!-- Banner de advertencia (solo para Huguito) -->
        <div class="srv-warning-banner" id="srv-warning-banner" role="status" aria-live="polite">
            <div class="srv-warning-content">
                <strong>Atenci√≥n ‚Äî Solo para Huguito (desarrollador)</strong>
                <span class="srv-warning-text">Este segmento es peligroso para uso general. Solo el desarrollador debe interactuar aqu√≠ ya que acciones incorrectas pueden da√±ar el servidor.</span>
            </div>
            <button class="srv-warning-close" id="srv-warning-close" aria-label="Cerrar aviso">‚úï</button>
        </div>

        <section class="server-section">
            <div class="card">
                <h3 class="card-title"><i class="fas fa-info-circle"></i> Estado del Servidor</h3>

                <div class="server-top-stats">
                        <div class="stat-card small">
                            <div class="stat-label">Uptime</div>
                            <div id="server-uptime" class="stat-value">-</div>
                        </div>
                        <div class="stat-card small">
                            <div class="stat-label">Solicitudes</div>
                            <div id="server-requests-count" class="stat-value">-</div>
                        </div>
                        <div class="stat-card small">
                            <div class="stat-label">Nuevos Pedidos</div>
                            <div id="new-orders-count" class="stat-value">-</div>
                        </div>
                        <div class="stat-card small">
                            <div class="stat-label">Usuarios (preview)</div>
                            <div id="server-users-count" class="stat-value">-</div>
                        </div>
                    </div>

                <div class="server-config-row">
                    <label for="server-base-url">Backend URL:</label>
                    <input id="server-base-url" class="input-dark server-url-input" type="text" readonly aria-readonly="true" title="La URL del backend est√° fijada y no puede cambiarse desde aqu√≠." />
                    <button id="btn-save-base-url" class="btn btn-secondary" disabled aria-disabled="true" title="No permitido">Guardar URL</button>
                    <label>Auto-refresh</label>
                    <input type="checkbox" id="server-auto-refresh" />
                    <select id="server-refresh-interval" class="select-dark">
                        <option value="15">15s</option>
                        <option value="30">30s</option>
                        <option value="60">60s</option>
                        <option value="300">5m</option>
                    </select>
                    <span id="server-last-updated">No actualizado</span>
                </div>

                <div class="server-output">
                    <div class="server-status-panel">
                        <h4>Informaci√≥n B√°sica</h4>
                        <pre id="server-status-pre" class="json-pre">No cargado</pre>
                    </div>

                    <div class="server-logs-panel">
                        <h4>Logs / Mensajes</h4>
                        <pre id="server-logs-pre" class="json-pre">Sin mensajes</pre>
                    </div>

                    <div class="server-data-panels">
                        <div class="panel">
                            <h4>Usuarios (preview)</h4>
                            <div id="server-users-preview" class="list-panel">N/A</div>
                        </div>
                            <div class="panel">
                                <h4>Usuarios por Pa√≠s</h4>
                                <div id="server-users-by-country" class="list-panel">N/A</div>
                                <div class="chart-container" style="margin-top:0.5rem;">
                                    <canvas id="chart-users-country" width="300" height="120"></canvas>
                                </div>
                            </div>
                        <div class="panel">
                            <h4>Nuevos Pedidos</h4>
                            <div id="new-orders-list" class="list-panel">N/A</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

        <footer class="footer">
            <div class="footer-content">
                <span class="footer-text">¬© 2025 Analytics-Asere ¬∑ v3.5.1</span>
                <div class="footer-links">
                    <a href="#"><i class="fas fa-book"></i> Creado por HLab</a>
                </div>
            </div>
        </footer>

        <!-- Modal de configuraci√≥n -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content">
                <h3><i class="fas fa-cog"></i> Configuraci√≥n</h3>
                
                <div class="settings-section">
                    <h4><i class="fas fa-key"></i> Llave de seguridad</h4>
                    <p>Configura tu llave de seguridad para actualizar los afiliados y las dem√°s cosas.</p>
                    
                    <div class="input-group">
                        <label for="current-token">Llave actual:</label>
                        <input type="password" id="current-token" class="input-dark" 
                            placeholder="ghp_tuTokenAqu√≠" value="" readonly>
                        <button id="show-token" class="btn small-btn">
                            <i class="fas fa-eye"></i> Mostrar
                        </button>
                    </div>
                    
                    <div class="modal-actions">
                        <button id="update-token-btn" class="btn btn-primary">
                            <i class="fas fa-sync-alt"></i> Cambiar llave
                        </button>
                        <button id="test-token-btn" class="btn btn-secondary">
                            <i class="fas fa-check"></i> Verificar llave
                        </button>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button id="close-settings" class="btn cancel-btn">
                        <i class="fas fa-times"></i> Cerrar
                    </button>
                </div>
            </div>
        </div>
        <!-- Spinner/Overlay para operaciones largas (guardar en GitHub) -->
        <div id="srv-spinner" class="srv-spinner hidden" aria-hidden="true">
            <div class="srv-spinner-box">
                <div class="srv-spinner-icon"></div>
                <div class="srv-spinner-text">Guardando pedidos en GitHub...</div>
            </div>
        </div>

        <!-- Modal de resultado de guardado -->
        <div id="srv-save-modal" class="srv-modal hidden" role="dialog" aria-modal="true" aria-labelledby="srv-save-modal-title">
            <div class="srv-modal-content">
                <h3 id="srv-save-modal-title">Resultado</h3>
                <div id="srv-save-modal-body">Esperando acci√≥n...</div>
                <div class="srv-modal-actions">
                    <button id="srv-save-modal-close" class="btn btn-primary">Cerrar</button>
                </div>
            </div>
        </div>
    
    </main>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="Js/config.js" defer></script>
    <script src="Js/script.js" defer></script>
    <script src="Js/servidor.js" defer></script>
    <script src="Js/floating-bot.js"></script>
</body>
</html>
